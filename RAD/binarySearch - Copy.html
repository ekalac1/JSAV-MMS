<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <title>Binary Search</title>
        <link rel="stylesheet" href="../css/JSAV.css" type="text/css" />
    </head>

    <body>
        <h1>Binary Search</h1>
        <div id="container">
            <p class="instructLabel">Instructions:</p>
            <p class="instructions">
                    Find the trazeni given in the exercise by highlighting the <strong>mid points</strong> used in Binary Search. The values are hidden and in <strong>ascending order</strong>.
            </p>
            <p align="center" class="jsavexercisecontrols"></p>
            <p style="text-align:center">Find</p>
            <ol id="trazeni"></ol>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
        <script src="../lib/jquery.transit.js"></script>
        <script src="../lib/raphael.js"></script>
        <script src="../build/JSAV.js"></script>
    
        <script>

        var arraySize = 20;
        var trazeni;
        var initialArray = new Array(arraySize),
        jsavArray,
        trazeniArray,
            av = new JSAV($("#container")),
            $array;

        av.recorded(); // we are not recording an AV with an algorithm

        function initialize() {
            //ako je jsavArray definisan, znaci da resetujemo vjezbu, pa treba ukloniti elemente
            if (jsavArray){
                jsavArray.clear();
                trazeniArray.clear();
            }
            
            randomVal = Math.floor(Math.random()*10);
            //uzlazna lista
            for (var i = 0; i < arraySize; i++) {
                randomVal += Math.floor(Math.random()*10 + 1);
                initialArray[i] = randomVal;
            }
            
            trazeni = initialArray[Math.floor(Math.random() * initialArray.length)];

            trazeniArray = av.ds.array([trazeni], {indexed: false});
            trazeniArray.css(0, {"background-color": "#ddf"});
            trazeniArray.toggleArrow(0);
            jsavArray = av.ds.array(new Array(arraySize), {indexed: true});
            jsavArray.layout();
            return jsavArray;
        }
        
        function modelSolution(jsav) {
            jsav.ds.array([trazeni], {indexed: false}).css(0, {"background-color": "#ddf"});
            var modelArray = jsav.ds.array(Array(arraySize), {indexed: true});

            jsav._undo = [];

            var prvi = 0, zadnji = arraySize - 1, mid;

            while (prvi <= zadnji) {
                mid = Math.floor( (prvi + zadnji)/2);
                jsav.umsg("prvi = " + prvi + " and zadnji = " + zadnji +
                    ", so mid = ( " + prvi + " + " + zadnji + " ) / 2 = <strong>" + mid + "</strong> (line 9, division truncates!)");
                modelArray.value(mid, initialArray[mid]);
                modelArray.highlight(mid);
                if (modelArray.value(mid) < trazeni) {
                    jsav.umsg("<br/>Because " + modelArray.value(mid) + " is less than " + trazeni + ", the new prvi will be <strong>" + (mid + 1) + "</strong>. (line 10 and 11)", {preserve: true});
                    prvi = mid + 1;
                }
                if (modelArray.value(mid) > trazeni) {
                    jsav.umsg("<br/>Because " + modelArray.value(mid) + " is greater than " + trazeni + ", the new zadnji will be <strong>" + (mid - 1) + "</strong>. (line 12 and 13)", {preserve: true});
                    zadnji = mid - 1;
                }
                if (modelArray.value(mid) === trazeni) {
                    jsav.umsg("<br/>The trazeni was found at index " + mid + "!", {preserve: true});
                }
                jsav.stepOption("grade", true);
                jsav.step();
                if (modelArray.value(mid) === trazeni) {
                    return modelArray;
                }
            }
            jsav.umsg("<br/>The trazeni wasn't found in the table.", {preserve: true});
            return modelArray;
        }
        
        var exercise = av.exercise(modelSolution, initialize, {}, {feedback: "atend"});
        exercise.reset();
        
        jsavArray.click(function(index) {
            
            if (!this.isHighlight(index)) {
                this.value(index, initialArray[index]);
                this.highlight(index);
                exercise.gradeableStep();
            }
        });

</script>
    </body>
</html>