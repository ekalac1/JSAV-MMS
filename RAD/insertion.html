<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <title>Insertion Sort</title>
        <link rel="stylesheet" href="../css/JSAV.css" type="text/css" />
        <!-- <link rel="stylesheet" href="opendsaAV.css" type="text/css" /> -->
        <style>
            #jsavcontainer {
              height: 600px;
            }
        </style>
    </head>

    <body>

        <h1>Insertion Sort</h1>
        <div id="jsavcontainer">
            <div class="jsavcontrols"></div>
            <span class="jsavcounter"></span>
            <!-- <a class="jsavsettings" href="#">Settings</a> -->
            <p class="jsavscore"></p>
            <ol id="modelArray"></ol>
            <!-- <p class="jsavoutput jsavline"></p> -->
        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <script src="../lib/jquery.transit.js"></script>
    <script src="../lib/raphael.js"></script>
    <script src="../build/JSAV.js"></script>

        <script>
            var arraySize = 10,
            initialArray = [],
            jsavArray,
            swapIndex,
            $array = $("#modelArray"),
            av = new JSAV($("#jsavcontainer")),
            code = av.code(
                "public static void insertionSort(int[] table) {\n"+
                "   for (int i = 0; i < table.length; i++) {\n"+
                "       int j = i;\n"+
                "       while (j > 0 && table[j - 1] > table[j]) {\n"+
                "           swap(table, j - 1, j);\n"+
                "           j--;\n"+
                "       }\n"+
                "   }\n"+
                "}");


            function initialize() {
            var htmldata = "";
            for (var i = 0; i < arraySize; i++) {
                randomVal = Math.floor(Math.random()*100) + 10;
                htmldata += "<li>" + randomVal + "</li>";
                initialArray[i] = randomVal;
            }
            $array.html(htmldata);
            swapIndex = av.variable(-1);
            av.forward();
            jsavArray = av.ds.array($array, {indexed: true, layout: "bar"});
            code.show();
            return jsavArray;
        }
            var curLine = 1;
            initialize();
            var oldfx;            
            av._undo = [];
            av.step();            
            code.setCurrentLine(2); 
            av.step();
            
            for (var i = 1; i < arraySize; i++) {
              code.setCurrentLine(3); 
              jsavArray.css(true, {"background-color": "#ddd"});              
              jsavArray.css(i, {"background-color": "#eee"});              

              if (curLine != 3)
              {
                av.step();              
                curLine = 3;
              }
              var j = i;
              code.setCurrentLine(4);               
              if (curLine != 4)
              {
                av.step();              
                curLine = 4;
              }
              while (j > 0 && parseInt(jsavArray.value(j-1)) > parseInt(jsavArray.value(j))) {
                code.setCurrentLine(5); 
                jsavArray.swap(j, j-1);
                jsavArray.css(true, {"background-color": "#ddd"});              
                jsavArray.css(j-1, {"background-color": "#eee"});              
                  av.step();
                j--;
                code.setCurrentLine(6); 
                av.step();
                code.setCurrentLine(4);
                curLine = 4;
                av.step();
                
              }
              if (curLine != 4)
              {
                code.setCurrentLine(4); 
                av.step();
                curLine = 4;
              }
            }
            av.recorded(); 
        </script>
    </body>
</html>
